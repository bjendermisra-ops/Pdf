<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wealth Growth Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script>
      tailwind.config = {
        theme: { extend: { fontFamily: { sans: ["Inter", "sans-serif"] } } },
      };
    </script>
  </head>
  <body
    class="bg-gradient-to-br from-green-50 to-emerald-50 text-gray-900 min-h-screen"
  >
    <nav>
      <a href="/" class="back-button">
        <i class="fas fa-arrow-left"></i> Back to All Tools
      </a>
    </nav>

    <style>
      nav {
        display: flex;
        justify-content: flex-start;
        align-items: center;
        padding: 1rem 1.5rem;
        background-color: rgba(255, 255, 255, 0.95);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
      }

      .back-button {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.5rem 1rem;
        background: linear-gradient(135deg, #2563eb, #1d4ed8);
        border-radius: 9999px;
        color: white;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.3s ease;
        box-shadow: 0 2px 6px rgba(37, 99, 235, 0.3);
      }

      .back-button i {
        font-size: 1rem;
      }

      .back-button:hover {
        background: linear-gradient(135deg, #1d4ed8, #1e40af);
        transform: translateX(-0.25rem);
        box-shadow: 0 4px 10px rgba(37, 99, 235, 0.4);
      }
    </style>

    <div class="container mx-auto px-4 py-8 max-w-6xl">
      <header class="text-center mb-10">
        <h1 class="text-5xl font-bold text-emerald-700 mb-2">
          Wealth Growth Calculator
        </h1>
        <p class="text-lg text-gray-600">
          Project your investments with compounding, contributions, and
          inflation
        </p>
      </header>

      <!-- Inputs -->
      <div class="bg-white rounded-xl shadow p-6 mb-6">
        <div class="grid md:grid-cols-4 gap-6">
          <div>
            <label class="block text-sm font-medium mb-2"
              >Initial Investment (₹)</label
            >
            <input
              type="number"
              id="principal"
              value="100000"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-emerald-500"
            />
          </div>
          <div>
            <label class="block text-sm font-medium mb-2"
              >Expected Return (% p.a.)</label
            >
            <input
              type="range"
              id="rate"
              min="0"
              max="20"
              step="0.1"
              value="8"
              class="w-full"
            />
            <input
              type="number"
              id="rate-value"
              value="8"
              step="0.1"
              class="w-full px-4 py-2 mt-1 border rounded text-sm"
            />
          </div>
          <div>
            <label class="block text-sm font-medium mb-2"
              >Time Horizon (Years)</label
            >
            <input
              type="number"
              id="years"
              value="10"
              min="1"
              max="50"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-emerald-500"
            />
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Compounding</label>
            <select
              id="frequency"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-emerald-500"
            >
              <option value="yearly">Yearly</option>
              <option value="quarterly">Quarterly</option>
              <option value="monthly">Monthly</option>
            </select>
          </div>
        </div>
        <div class="grid md:grid-cols-3 gap-6 mt-6">
          <div>
            <label class="block text-sm font-medium mb-2"
              >Monthly Contribution (₹)</label
            >
            <input
              type="number"
              id="contribution"
              value="5000"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-emerald-500"
            />
          </div>
          <div>
            <label class="block text-sm font-medium mb-2"
              >Inflation Rate (%)</label
            >
            <input
              type="number"
              id="inflation"
              value="6"
              step="0.1"
              class="w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-emerald-500"
            />
          </div>
          <div class="flex items-end">
            <button
              id="calculate"
              class="w-full px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700"
            >
              Calculate Growth
            </button>
          </div>
        </div>
      </div>

      <!-- Results -->
      <div class="grid md:grid-cols-4 gap-6 mb-6">
        <div
          class="bg-gradient-to-r from-emerald-500 to-emerald-600 text-white p-6 rounded-xl"
        >
          <p class="text-sm opacity-90">Future Value</p>
          <p id="future-value" class="text-3xl font-bold">₹0</p>
        </div>
        <div
          class="bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-xl"
        >
          <p class="text-sm opacity-90">Total Invested</p>
          <p id="total-invested" class="text-3xl font-bold">₹0</p>
        </div>
        <div
          class="bg-gradient-to-r from-teal-500 to-teal-600 text-white p-6 rounded-xl"
        >
          <p class="text-sm opacity-90">Total Returns</p>
          <p id="total-returns" class="text-3xl font-bold">₹0</p>
        </div>
        <div
          class="bg-gradient-to-r from-indigo-500 to-indigo-600 text-white p-6 rounded-xl"
        >
          <p class="text-sm opacity-90">CAGR</p>
          <p id="cagr" class="text-3xl font-bold">0%</p>
        </div>
      </div>

      <!-- Real vs Nominal -->
      <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div class="bg-white p-6 rounded-xl shadow">
          <p class="text-sm text-gray-600">Nominal Value</p>
          <p id="nominal-value" class="text-3xl font-bold text-emerald-600">
            ₹0
          </p>
        </div>
        <div class="bg-white p-6 rounded-xl shadow">
          <p class="text-sm text-gray-600">Real Value (Inflation Adj.)</p>
          <p id="real-value" class="text-3xl font-bold text-indigo-600">₹0</p>
        </div>
      </div>

      <!-- Growth Table -->
      <div class="bg-white rounded-xl shadow p-6 mb-6">
        <h3 class="text-lg font-semibold mb-4">Yearly Breakdown</h3>
        <div class="overflow-x-auto">
          <table id="growth-table" class="w-full table-auto">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-4 py-2 text-left">Year</th>
                <th class="px-4 py-2 text-right">Start</th>
                <th class="px-4 py-2 text-right">Contribution</th>
                <th class="px-4 py-2 text-right">Interest</th>
                <th class="px-4 py-2 text-right">End</th>
              </tr>
            </thead>
            <tbody id="table-body"></tbody>
          </table>
        </div>
      </div>

      <!-- Charts -->
      <div class="grid md:grid-cols-2 gap-6 mb-6">
        <div class="bg-white rounded-xl shadow p-6">
          <h3 class="text-lg font-semibold mb-4">Wealth Growth Over Time</h3>
          <canvas id="growthChart" height="120"></canvas>
        </div>
        <div class="bg-white rounded-xl shadow p-6">
          <h3 class="text-lg font-semibold mb-4">Breakdown (Pie)</h3>
          <canvas id="pieChart" height="120"></canvas>
        </div>
      </div>

      <!-- Export -->
      <div class="text-center">
        <button
          id="export-pdf"
          class="px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 mr-3"
        >
          Export PDF
        </button>
        <button
          id="export-csv"
          class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700"
        >
          Export CSV
        </button>
      </div>
    </div>

    <script>
      // DOM Elements
      const principal = document.getElementById("principal");
      const rate = document.getElementById("rate");
      const rateValue = document.getElementById("rate-value");
      const years = document.getElementById("years");
      const frequency = document.getElementById("frequency");
      const contribution = document.getElementById("contribution");
      const inflation = document.getElementById("inflation");
      const calculateBtn = document.getElementById("calculate");

      const futureValueEl = document.getElementById("future-value");
      const totalInvestedEl = document.getElementById("total-invested");
      const totalReturnsEl = document.getElementById("total-returns");
      const cagrEl = document.getElementById("cagr");
      const nominalValueEl = document.getElementById("nominal-value");
      const realValueEl = document.getElementById("real-value");

      const tableBody = document.getElementById("table-body");
      const exportPdf = document.getElementById("export-pdf");
      const exportCsv = document.getElementById("export-csv");
      const growthCtx = document.getElementById("growthChart").getContext("2d");
      const pieCtx = document.getElementById("pieChart").getContext("2d");

      let growthChart = null;
      let pieChart = null;
      let profile = {};

      // Rate Slider Sync
      rate.addEventListener("input", () => {
        rateValue.value = rate.value;
      });
      rateValue.addEventListener("input", () => {
        rate.value = rateValue.value;
      });

      // Compound Interest with Contributions
      function calculateWealth(p, r, t, contrib, freq, inflationRate) {
        const n = { yearly: 1, quarterly: 4, monthly: 12 }[freq];
        const periods = t * n;
        const periodRate = r / 100 / n;
        const inflationPeriod = inflationRate / 100 / n;

        let fv = p;
        let totalContrib = 0;
        let yearlyData = [];

        for (let i = 1; i <= periods; i++) {
          fv = fv * (1 + periodRate) + contrib;
          totalContrib += contrib / n; // Adjust for frequency
          if (i % n === 0) {
            yearlyData.push({
              year: Math.floor(i / n),
              start: Math.round(fv - contrib / n),
              contrib: Math.round(contrib / n),
              interest: Math.round((fv - contrib / n) * periodRate * n),
              end: Math.round(fv),
            });
          }
        }

        const nominal = fv;
        const real = fv / Math.pow(1 + inflationPeriod, periods); // Inflation-adjusted
        const cagr = ((nominal / p) ** (1 / t) - 1) * 100;

        return {
          nominal,
          real: Math.round(real),
          totalContrib: Math.round(totalContrib),
          cagr,
          yearlyData,
        };
      }

      // Main Calculation
      calculateBtn.addEventListener("click", () => {
        const p = parseFloat(principal.value) || 0;
        const r = parseFloat(rate.value) || 0;
        const t = parseFloat(years.value) || 0;
        const contrib = parseFloat(contribution.value) || 0;
        const freq = frequency.value;
        const infl = parseFloat(inflation.value) || 0;

        if (p <= 0 || t <= 0) return;

        const { nominal, real, totalContrib, cagr, yearlyData } =
          calculateWealth(p, r, t, contrib, freq, infl);

        futureValueEl.textContent = `₹${nominal.toLocaleString()}`;
        totalInvestedEl.textContent = `₹${(p + totalContrib).toLocaleString()}`;
        totalReturnsEl.textContent = `₹${(
          nominal -
          p -
          totalContrib
        ).toLocaleString()}`;
        cagrEl.textContent = `${cagr.toFixed(2)}%`;
        nominalValueEl.textContent = `₹${nominal.toLocaleString()}`;
        realValueEl.textContent = `₹${real.toLocaleString()}`;

        profile = {
          p,
          r,
          t,
          contrib,
          freq,
          infl,
          nominal,
          real,
          totalContrib,
          cagr,
          yearlyData,
        };
        renderTable(yearlyData);
        updateGrowthChart(yearlyData);
        updatePieChart(nominal, p + totalContrib);
        saveProfile();
      });

      function renderTable(data) {
        tableBody.innerHTML = "";
        data.forEach((row) => {
          const tr = tableBody.insertRow();
          tr.innerHTML = `
          <td class="px-4 py-2 font-medium">Year ${row.year}</td>
          <td class="px-4 py-2 text-right">₹${row.start.toLocaleString()}</td>
          <td class="px-4 py-2 text-right text-green-600">₹${row.contrib.toLocaleString()}</td>
          <td class="px-4 py-2 text-right text-blue-600">₹${row.interest.toLocaleString()}</td>
          <td class="px-4 py-2 text-right font-bold">₹${row.end.toLocaleString()}</td>
        `;
        });
      }

      function updateGrowthChart(data) {
        if (growthChart) growthChart.destroy();
        const labels = data.map((d) => `Year ${d.year}`);
        const values = data.map((d) => d.end);

        growthChart = new Chart(growthCtx, {
          type: "line",
          data: {
            labels,
            datasets: [
              {
                label: "Wealth (₹)",
                data: values,
                borderColor: "#10b981",
                backgroundColor: "rgba(16, 185, 129, 0.1)",
                fill: true,
                tension: 0.4,
              },
            ],
          },
          options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true } },
          },
        });
      }

      function updatePieChart(nominal, invested) {
        if (pieChart) pieChart.destroy();
        const returns = nominal - invested;
        const principalShare = (p / invested) * 100;
        const contribShare = ((invested - p) / invested) * 100;
        const returnShare = (returns / nominal) * 100;

        pieChart = new Chart(pieCtx, {
          type: "pie",
          data: {
            labels: ["Initial", "Contributions", "Returns"],
            datasets: [
              {
                data: [p, invested - p, returns],
                backgroundColor: ["#3b82f6", "#10b981", "#f59e0b"],
                borderWidth: 2,
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              tooltip: {
                callbacks: {
                  label: (ctx) =>
                    `₹${ctx.parsed.toLocaleString()} (${(
                      (ctx.parsed / nominal) *
                      100
                    ).toFixed(1)}%)`,
                },
              },
              legend: { position: "bottom" },
            },
          },
        });
      }

      // Export PDF
      exportPdf.addEventListener("click", () => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.setFontSize(16);
        doc.text("Wealth Growth Report", 105, 15, { align: "center" });
        doc.setFontSize(12);
        let y = 30;
        doc.text(
          `Initial: ₹${principal.value} | Rate: ${rate.value}% | Years: ${years.value}`,
          20,
          y
        );
        y += 7;
        doc.text(
          `Monthly Contrib: ₹${contribution.value} | Inflation: ${inflation.value}%`,
          20,
          y
        );
        y += 7;
        doc.text(
          `Future Value: ₹${profile.nominal.toLocaleString()} | CAGR: ${profile.cagr.toFixed(
            2
          )}%`,
          20,
          y
        );
        y += 7;
        doc.text(
          `Real Value: ₹${profile.real.toLocaleString()} | Total Invested: ₹${(
            principal.value + profile.totalContrib
          ).toLocaleString()}`,
          20,
          y
        );

        // Table
        const tableData = profile.yearlyData.map((row) => [
          row.year,
          `₹${row.start.toLocaleString()}`,
          `₹${row.contrib.toLocaleString()}`,
          `₹${row.interest.toLocaleString()}`,
          `₹${row.end.toLocaleString()}`,
        ]);
        doc.autoTable({
          head: [["Year", "Start", "Contribution", "Interest", "End"]],
          body: tableData,
          startY: y,
        });

        doc.save("wealth_report.pdf");
      });

      // Export CSV
      exportCsv.addEventListener("click", () => {
        let csv = "Year,Start,Contribution,Interest,End\n";
        profile.yearlyData.forEach((row) => {
          csv += `${
            row.year
          },₹${row.start.toLocaleString()},₹${row.contrib.toLocaleString()},₹${row.interest.toLocaleString()},₹${row.end.toLocaleString()}\n`;
        });
        const blob = new Blob([csv], { type: "text/csv" });
        const url = URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = "wealth_growth.csv";
        a.click();
      });

      // Local Storage
      function saveProfile() {
        localStorage.setItem(
          "wealthProfile",
          JSON.stringify({
            principal: principal.value,
            rate: rate.value,
            years: years.value,
            frequency: frequency.value,
            contribution: contribution.value,
            inflation: inflation.value,
          })
        );
      }

      function loadProfile() {
        const saved = JSON.parse(localStorage.getItem("wealthProfile"));
        if (saved) {
          principal.value = saved.principal;
          rate.value = saved.rate;
          rateValue.value = saved.rate;
          years.value = saved.years;
          frequency.value = saved.frequency;
          contribution.value = saved.contribution;
          inflation.value = saved.inflation;
          calculateBtn.click();
        }
      }

      // Init
      loadProfile();
    </script>
  </body>
</html>